<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Task Script Board</title>
  <link rel="stylesheet" href="styles/styles.css" />
  <link rel="stylesheet" href="node_modules/@fortawesome/fontawesome-free/css/all.min.css" />
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
</head>

<body>
  <div class="app">
    <section class="editor-panel">
      <header>
        <div class="editor-toolbar">
          <div class="board-title">
            <h1 id="board-title">Task Script</h1>
            <div id="board-connection" class="board-connection hidden"></div>
          </div>
          <div class="toolbar-actions">
            <button id="undo-button" class="toolbar-icon" type="button" aria-label="Undo" title="Undo">
              <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
            </button>
            <button id="redo-button" class="toolbar-icon" type="button" aria-label="Redo" title="Redo">
              <i class="fa-solid fa-rotate-right" aria-hidden="true"></i>
            </button>
            <button id="load-button" class="toolbar-icon" type="button" aria-label="Load from disk" title="Load from disk">
              <i class="fa-solid fa-upload" aria-hidden="true"></i>
            </button>
            <button id="save-button" class="toolbar-icon" type="button" aria-label="Download" title="Download">
              <i class="fa-solid fa-download" aria-hidden="true"></i>
            </button>
            <button id="format-button" class="toolbar-icon" type="button" aria-label="Run autoformat" title="Run autoformat">
              <i class="fa-solid fa-wand-magic-sparkles" aria-hidden="true"></i>
            </button>
            <button id="connect-button" class="toolbar-icon" type="button" aria-label="Login" title="Login">
              <i class="fa-solid fa-plug" aria-hidden="true"></i>
            </button>
            <button id="theme-button" class="toolbar-icon" type="button" aria-label="Toggle light/dark mode" title="Toggle light/dark mode">
              <i class="fa-solid fa-moon" aria-hidden="true"></i>
            </button>
            <button id="fullscreen-button" class="toolbar-icon" type="button" aria-label="Toggle fullscreen"
              title="Toggle fullscreen">
              <i class="fa-solid fa-expand" aria-hidden="true"></i>
            </button>
            <input id="file-input" type="file" accept=".txt,text/plain" hidden />
          </div>
        </div>
      </header>
      <div class="editor-wrapper">
        <textarea id="task-editor" spellcheck="false" aria-hidden="true" tabindex="-1"></textarea>
        <div id="code-editor" class="code-editor" aria-label="Task script editor"></div>
      </div>
    </section>
    <div class="divider" id="divider" role="separator" aria-orientation="vertical"></div>
    <section class="graph-panel">
      <div id="graph-canvas" class="graph-canvas">
        <svg id="graph-lines"></svg>
        <div id="graph-nodes" class="graph-nodes"></div>
        <div id="graph-minimap" class="graph-minimap" aria-hidden="true">
          <svg id="minimap-svg" class="minimap-svg"></svg>
        </div>
        <div class="graph-search">
          <input id="search-input" type="text" placeholder="Search tasks" />
          <div class="search-options">
            <label><input type="checkbox" id="search-name" checked /> Name</label>
            <label><input type="checkbox" id="search-description" checked /> Description</label>
            <label><input type="checkbox" id="search-tag" checked /> Tag</label>
            <label><input type="checkbox" id="search-person" checked /> Person</label>
          </div>
        </div>
        <div id="task-trash" class="task-trash" role="button" aria-label="Delete task" aria-hidden="true">
          <i class="fa-solid fa-trash-can" aria-hidden="true"></i>
        </div>
        <div class="graph-footer">
          <button id="clear-filters" class="toolbar-button">Clear Highlights</button>
        </div>
      </div>
      <div class="legend">
        <div class="legend-group legend-people">
          <h3>People</h3>
          <div id="person-list" class="pill-list"></div>
        </div>
        <div class="legend-group legend-tags">
          <h3>Tags</h3>
          <div id="tag-list" class="pill-list"></div>
        </div>
      </div>
      <div id="kanban-divider" class="kanban-divider" role="separator" aria-orientation="horizontal"></div>
      <div id="kanban-board" class="kanban-board" aria-label="Kanban board">
        <div id="kanban-content" class="kanban-content"></div>
        <div class="kanban-group-float" aria-label="Kanban swimlane grouping">
          <div id="kanban-group" class="kanban-group" role="radiogroup" aria-label="Kanban swimlane grouping">
            <button type="button" class="kanban-group-button" data-kanban-group="none" role="radio" aria-checked="true">
              No grouping
            </button>
            <button type="button" class="kanban-group-button" data-kanban-group="person" role="radio" aria-checked="false">
              Person
            </button>
            <button type="button" class="kanban-group-button" data-kanban-group="tag" role="radio" aria-checked="false">
              Tag
            </button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div id="login-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="login-modal-title">
    <div class="modal-card">
      <div class="modal-header">
        <h2 id="login-modal-title">User Login</h2>
        <button id="login-modal-close" class="toolbar-icon" type="button" aria-label="Close">
          <i class="fa-solid fa-xmark" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="modal-help">Enter your credentials to access shared spaces.</div>
        <div class="modal-fields">
          <label class="modal-field">
            <span>Username</span>
            <input id="login-username" type="text" autocomplete="username" placeholder="username" />
          </label>
          <label class="modal-field">
            <span>Display name (optional)</span>
            <input id="login-displayname" type="text" autocomplete="nickname" placeholder="Display name" />
          </label>
          <label class="modal-field">
            <span>Password</span>
            <input id="login-password" type="password" autocomplete="current-password" value="devtoken" />
          </label>
        </div>
        <div id="login-error" class="modal-error hidden">Invalid credentials.</div>
        <div class="modal-actions">
          <button id="login-submit" class="toolbar-button" type="button">Login</button>
        </div>
      </div>
    </div>
  </div>

  <div id="spaces-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="spaces-modal-title">
    <div class="modal-card">
      <div class="modal-header">
        <h2 id="spaces-modal-title">Spaces</h2>
        <div class="modal-header-actions">
          <button id="logout-button" class="toolbar-button" type="button">Logout</button>
          <button id="spaces-modal-close" class="toolbar-icon" type="button" aria-label="Close">
            <i class="fa-solid fa-xmark" aria-hidden="true"></i>
          </button>
        </div>
      </div>
      <div class="modal-body">
        <div class="modal-help">Select a space to collaborate on.</div>
        <div class="space-create">
          <input id="space-new" type="text" placeholder="New space name" />
          <button id="space-create" class="toolbar-button" type="button">Add space</button>
        </div>
        <div id="space-error" class="modal-error hidden"></div>
        <div id="space-list" class="space-list"></div>
      </div>
    </div>
  </div>

  <div id="delete-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title">
    <div class="modal-card">
      <div class="modal-header">
        <h2 id="delete-modal-title">Delete Space</h2>
      </div>
      <div class="modal-body">
        <div id="delete-modal-message" class="modal-help"></div>
        <div class="modal-actions">
          <button id="delete-cancel" class="toolbar-button success" type="button">Cancel</button>
          <button id="delete-confirm" class="toolbar-button danger" type="button">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <div id="task-delete-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="task-delete-title">
    <div class="modal-card">
      <div class="modal-header">
        <h2 id="task-delete-title">Remove Task</h2>
      </div>
      <div class="modal-body">
        <div id="task-delete-message" class="modal-help"></div>
        <div class="modal-actions">
          <button id="task-delete-confirm" class="toolbar-button danger" type="button">Remove</button>
          <button id="task-delete-confirm-all" class="toolbar-button danger" type="button">Remove with all subtasks</button>
          <button id="task-delete-cancel" class="toolbar-button" type="button">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <div id="task-edit-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="task-edit-title-label">
    <div class="modal-card task-edit-card">
      <div class="modal-header task-edit-header">
        <label class="modal-field task-edit-title-field">
          <span id="task-edit-title-label">Title</span>
          <input id="task-edit-title-input" type="text" />
        </label>
      </div>
      <div class="modal-body task-edit-body">
        <div class="task-edit-layout">
          <div class="task-edit-main">
            <div id="task-edit-preview" class="task-edit-preview"></div>
            <div class="task-edit-code">
              <textarea id="task-edit-code" spellcheck="false" aria-hidden="true" tabindex="-1"></textarea>
              <div id="task-edit-code-editor" class="code-editor task-edit-code-editor" aria-label="Task editor"></div>
            </div>
          </div>
          <aside id="task-edit-side" class="task-edit-side" aria-label="Task tokens">
            <div class="task-edit-list">
              <h3>State</h3>
              <div id="task-edit-states" class="modal-token-list"></div>
            </div>
            <div class="task-edit-list">
              <h3>People</h3>
              <div id="task-edit-people" class="modal-token-list"></div>
            </div>
            <div class="task-edit-list">
              <h3>Tags</h3>
              <div id="task-edit-tags" class="modal-token-list"></div>
            </div>
          </aside>
        </div>
        <div id="task-edit-error" class="modal-error hidden"></div>
        <div class="modal-actions">
          <button id="task-edit-cancel" class="toolbar-button" type="button">Cancel</button>
          <button id="task-edit-save" class="toolbar-button success" type="button">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script type="importmap">
    {
      "imports": {
        "yjs": "/node_modules/yjs/dist/yjs.mjs",
        "y-websocket": "/node_modules/y-websocket/src/y-websocket.js",
        "y-textarea": "/node_modules/y-textarea/dist/y-textArea.es.js",
        "lib0/array": "/node_modules/lib0/array.js",
        "lib0/binary": "/node_modules/lib0/binary.js",
        "lib0/broadcastchannel": "/node_modules/lib0/broadcastchannel.js",
        "lib0/buffer": "/node_modules/lib0/buffer.js",
        "lib0/decoding": "/node_modules/lib0/decoding.js",
        "lib0/encoding": "/node_modules/lib0/encoding.js",
        "lib0/environment": "/node_modules/lib0/environment.js",
        "lib0/error": "/node_modules/lib0/error.js",
        "lib0/function": "/node_modules/lib0/function.js",
        "lib0/iterator": "/node_modules/lib0/iterator.js",
        "lib0/logging": "/node_modules/lib0/logging.js",
        "lib0/map": "/node_modules/lib0/map.js",
        "lib0/math": "/node_modules/lib0/math.js",
        "lib0/object": "/node_modules/lib0/object.js",
        "lib0/observable": "/node_modules/lib0/observable.js",
        "lib0/promise": "/node_modules/lib0/promise.js",
        "lib0/random": "/node_modules/lib0/random.js",
        "lib0/set": "/node_modules/lib0/set.js",
        "lib0/string": "/node_modules/lib0/string.js",
        "lib0/time": "/node_modules/lib0/time.js",
        "lib0/url": "/node_modules/lib0/url.js",
        "lib0/webcrypto": "/node_modules/lib0/webcrypto.js",
        "y-protocols/awareness": "/node_modules/y-protocols/awareness.js",
        "y-protocols/auth": "/node_modules/y-protocols/auth.js",
        "y-protocols/sync": "/node_modules/y-protocols/sync.js",
        "@codemirror/state": "/node_modules/@codemirror/state/dist/index.js",
        "@codemirror/view": "/node_modules/@codemirror/view/dist/index.js",
        "@codemirror/commands": "/node_modules/@codemirror/commands/dist/index.js",
        "@codemirror/autocomplete": "/node_modules/@codemirror/autocomplete/dist/index.js",
        "@codemirror/search": "/node_modules/@codemirror/search/dist/index.js",
        "@codemirror/language": "/node_modules/@codemirror/language/dist/index.js",
        "@marijn/find-cluster-break": "/node_modules/@marijn/find-cluster-break/src/index.js",
        "crelt": "/node_modules/crelt/index.js",
        "style-mod": "/node_modules/style-mod/src/style-mod.js",
        "w3c-keyname": "/node_modules/w3c-keyname/index.js",
        "@lezer/common": "/node_modules/@lezer/common/dist/index.js",
        "@lezer/highlight": "/node_modules/@lezer/highlight/dist/index.js",
        "@lezer/lr": "/node_modules/@lezer/lr/dist/index.js"
      }
    }
  </script>
  <script type="module" src="scripts/app.js"></script>
</body>

</html>
